import{jsx as n}from"react/jsx-runtime";import{createContext as r,useState as t,useContext as e,useMemo as c,useCallback as o,useEffect as a}from"react";function u(){return u=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},u.apply(this,arguments)}var i=r({stack:[],launchModal:function(){},updateStack:function(){},updateState:function(){}}),l=function(r){var e=r.children,c=t([]),o=c[0],a=c[1];return n(i.Provider,{value:{stack:o,launchModal:function(n,r,t){var e=Object.keys(r).reduce(function(n,t){var e=r[t];return n[t]=function(n){try{return Promise.resolve(e(n)).then(function(n){return a(o.slice(0,-1)),n})}catch(n){return Promise.reject(n)}},n},{});a([].concat(o,[{render:n,resolvers:e,onBackdropClickUse:t,state:{}}]))},updateStack:a,updateState:function(n){var r=[].concat(o);r[o.length-1].state=u({},n),a(r)}},children:e})};function s(){return e(i)}function d(){return s().launchModal}var f=function(r){var t=r.onModalLaunch,e=r.onModalClose,u=r.render,i=s().stack,l=c(function(){return i.length>0?i[i.length-1]:null},[i]),d=o(function(n){n.currentTarget===n.target&&(null==l?void 0:l.onBackdropClickUse)&&l.resolvers[l.onBackdropClickUse](n)},[l]);return a(function(){l?t&&t():e&&e()},[l,t,e]),l&&n(u,{onBackdropClick:d,children:l.render(l.resolvers)})||null};export{l as ModalContextProvider,f as ModalPort,d as useModal,s as useModalContext};
//# sourceMappingURL=index.mjs.map
