import{jsx as t}from"react/jsx-runtime";import{createContext as e,useState as n,useContext as r,useMemo as o,useCallback as a,useEffect as c}from"react";function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s.apply(this,arguments)}const l=e({stack:[],launchModal:()=>{},updateStack:()=>{},updateState:()=>{}}),u=({children:e})=>{const[r,o]=n([]);return t(l.Provider,{value:{stack:r,launchModal:(t,e,n)=>{const a=Object.keys(e).reduce((t,n)=>{const a=e[n];return t[n]=async t=>{const e=await a(t);return o(r.slice(0,-1)),e},t},{});o([...r,{render:t,resolvers:a,onBackdropClickUse:n,state:{}}])},updateStack:o,updateState:t=>{const e=[...r];e[r.length-1].state=s({},t),o(e)}},children:e})};function i(){return r(l)}function d(){const{launchModal:t}=i();return t}function p(){const{stack:t,updateState:e}=i();if(0===t.length)throw new Error("Trying to access modal state while no modal is open");return[t[t.length-1].state,e]}const h=({onModalLaunch:e,onModalClose:n,render:r})=>{const{stack:s}=i(),l=o(()=>s.length>0?s[s.length-1]:null,[s]),u=a(t=>{t.currentTarget===t.target&&(null==l?void 0:l.onBackdropClickUse)&&l.resolvers[l.onBackdropClickUse](t)},[l]);return c(()=>{l?e&&e():n&&n()},[l,e,n]),l&&t(r,{onBackdropClick:u,children:l.render(l.resolvers)})||null};export{u as ModalContextProvider,h as ModalPort,d as useModal,i as useModalContext,p as useModalState};
//# sourceMappingURL=index.modern.mjs.map
